# Configuration file for DDoS Detection System
# Copy this file to config.yaml and adjust the values

# ClickHouse Database Configuration (Akvorado)
clickhouse:
  host: "localhost"
  port: 9000
  database: "flows"
  user: "default"
  password: ""

# Detection Settings
detection:
  # Check interval in seconds
  check_interval: 60
  
  # Time window for analysis in seconds
  time_window: 300
  
  # Thresholds for DoS/DDoS detection
  thresholds:
    # Total external traffic threshold (bytes per second)
    # Detection only triggers if total external traffic exceeds this
    total_external_bps_threshold: 1000000000  # 1 Gbps
    
    # Per-destination traffic threshold (bytes per second)
    # Individual destinations are checked if they exceed this
    dst_bps_threshold: 1000000000  # 1 Gbps
    
    # Entropy threshold to distinguish DoS from DDoS
    # Values > this threshold indicate DDoS (distributed attack)
    # Values <= this threshold indicate DoS (single or few sources)
    entropy_threshold: 0.8

# Notification Settings
notifications:
  # Discord webhook URL (leave empty to disable)
  discord_webhook: ""
  
  # Slack webhook URL (leave empty to disable)
  slack_webhook: ""
  
  # Minimum time between notifications for the same target (seconds)
  cooldown: 300

# Logging
logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR, CRITICAL
  file: "ddos_detector.log"
